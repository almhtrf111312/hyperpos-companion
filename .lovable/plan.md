
# تخصيص التطبيق حسب نوع النشاط التجاري - خطة مقسمة إلى مراحل

## نظرة عامة
المطلوب تغييرات كبيرة تشمل: التحقق من المدخلات، إعادة تنظيم الإعدادات، وتخصيص كامل واجهة التطبيق حسب نوع المحل. سيتم تقسيم العمل إلى 4 مراحل.

---

## المرحلة 1: إصلاحات سريعة (التحقق من المدخلات + إعادة تسمية التبويبات + نقل اللغة والعملات)

### 1.1 حقول الهاتف تقبل أرقام فقط
- إضافة `inputMode="tel"` و `pattern` على جميع حقول الهاتف في الإعدادات وحوارات المستخدمين
- منع إدخال الأحرف في حقول الهاتف عبر فلتر `onChange`
- الملفات: `src/pages/Settings.tsx`

### 1.2 إعادة تسمية التبويبات
- "الملف الشخصي" → "إعدادات الملف الشخصي" / "Profile Settings"
- "المتجر" → "إعدادات المتجر" / "Store Settings"
- الملفات: `src/lib/i18n.ts`

### 1.3 نقل اللغة والعملات داخل تبويب "إعدادات المتجر"
- إزالة تبويب "اللغة" وتبويب "العملات" من القائمة الرئيسية
- إضافتهما كأقسام فرعية داخل تبويب "إعدادات المتجر" (بعد معلومات المحل)
- الملفات: `src/pages/Settings.tsx`

### 1.4 إخفاء قسم الصيانة تلقائيا
- عند تغيير نوع المحل، إذا لم يكن "هواتف" أو "ورشة صيانة"، يتم إخفاء قسم الصيانة تلقائيا (بدل الاعتماد على Switch يدوي فقط)
- الملفات: `src/pages/Settings.tsx`

---

## المرحلة 2: نظام المصطلحات الديناميكي

### المفهوم
إنشاء ملف تكوين `src/lib/store-type-config.ts` يحتوي على مصطلحات كل نوع نشاط:

| المصطلح الأصلي | هواتف | بقالة | صيدلية | ملابس | متجر عام |
|:---|:---|:---|:---|:---|:---|
| منتج | منتج | منتج | دواء/مستحضر | قطعة | منتج |
| إضافة منتج | إضافة منتج | إضافة منتج | إضافة دواء | إضافة قطعة | إضافة منتج |
| المنتجات | المنتجات | المنتجات | الأدوية | الأصناف | المنتجات |
| التصنيف | التصنيف | التصنيف | التصنيف الدوائي | النوع | التصنيف |
| الباركود | الباركود/IMEI | الباركود | الباركود | الباركود | الباركود |
| الصيانة | الصيانة | (مخفي) | (مخفي) | (مخفي) | (مخفي) |
| سعر البيع | سعر البيع | سعر البيع | سعر البيع | سعر البيع | سعر البيع |

### الملفات المتأثرة
- جديد: `src/lib/store-type-config.ts`
- تعديل: `src/lib/i18n.ts` (إضافة مفاتيح ديناميكية)
- تعديل: `src/hooks/use-language.tsx` (إضافة دالة `tDynamic` تقرأ نوع المحل)

---

## المرحلة 3: تطبيق المصطلحات على واجهات التطبيق

تحديث جميع الصفحات لاستخدام المصطلحات الديناميكية:
- `src/pages/Products.tsx` - عنوان الصفحة وأزرار الإضافة
- `src/pages/POS.tsx` - عناوين الأقسام
- `src/components/layout/Sidebar.tsx` - أسماء القوائم
- `src/components/dashboard/QuickActions.tsx` - الإجراءات السريعة
- `src/components/dashboard/TopProducts.tsx` - عنوان القسم
- `src/components/dashboard/LowStockAlerts.tsx` - التنبيهات

---

## المرحلة 4: الحقول والتصنيفات الافتراضية حسب النشاط

عند تغيير نوع المحل، يتم:
- تفعيل/إلغاء حقول المنتجات المناسبة تلقائيا (مثلا: تاريخ الصلاحية للبقالة والصيدلية)
- اقتراح تصنيفات افتراضية مناسبة (أدوية: مسكنات، مضادات حيوية... / ملابس: بيجاما، كنزة، بنطلون...)
- إخفاء/إظهار أقسام في القائمة الجانبية (الصيانة فقط للهواتف والإلكترونيات)

---

## التفاصيل التقنية

### المرحلة 1 - التغييرات التقنية:

**`src/lib/i18n.ts`:**
```text
'settings.profile' → 'إعدادات الملف الشخصي' / 'Profile Settings'
'settings.store' → 'إعدادات المتجر' / 'Store Settings'
```

**`src/pages/Settings.tsx`:**
- إزالة تبويبات `language` و `currencies` من مصفوفة `settingsTabs`
- إضافة محتوى اللغة والعملات داخل `case 'store'` في `renderTabContent`
- إضافة فلتر أرقام فقط على حقول الهاتف:
```text
onChange={(e) => {
  const val = e.target.value.replace(/[^\d+\-\s]/g, '');
  setStoreSettings({ ...storeSettings, phone: val });
}}
```
- ربط `hideMaintenanceSection` تلقائيا بنوع المحل

### المرحلة 2 - بنية ملف التكوين:
```text
store-type-config.ts:
  getTerminology(storeType, key) → string
  getDefaultCategories(storeType) → string[]
  getVisibleSections(storeType) → { maintenance, warranty, expiry, ... }
```

---

## ترتيب التنفيذ المقترح
1. ✅ المرحلة 1 - إصلاحات سريعة ومحسوسة
2. ✅ المرحلة 2 - بناء نظام المصطلحات
3. ✅ المرحلة 3 - تطبيق المصطلحات على الواجهات
4. المرحلة 4 (التالية) - التصنيفات والحقول الافتراضية

هل توافق على البدء بالمرحلة 1؟
