

## خطة: تحسين سلة المبيعات + تقسيم إعدادات المتجر

---

### نظرة عامة
ثلاث مهام رئيسية:
1. إضافة حقل "المبلغ المقبوض" لجميع أوضاع البيع (وليس فقط الجملة)
2. التأكد من أن تعديل السعر الإفرادي يعمل بشكل صحيح في السلة
3. تقسيم تبويب "المتجر" في الإعدادات إلى تبويبين فرعيين

---

### التغييرات المطلوبة

#### 1. تعديل `CartPanel.tsx` - حقل المبلغ المقبوض للبيع العادي

حالياً حقل "المبلغ المقبوض" يظهر فقط في وضع الجملة (`wholesaleMode`). التغيير:
- إظهار حقل "المبلغ المقبوض" دائماً (في البيع العادي وفي الجملة)
- في البيع العادي: يُحسب الباقي = المبلغ المقبوض - الإجمالي
- إظهار سطر "الباقي" في الملخص إذا كان المبلغ المقبوض أكبر من الإجمالي
- حقل المبلغ المقبوض يُعرض بعد الخصومات وقبل الملخص

#### 2. تأكيد عمل تعديل السعر الإفرادي

الكود الحالي يحتوي بالفعل على حقل تعديل السعر (`onUpdateItemPrice`) في كل منتج بالسلة (سطر 1316-1325). يجب:
- التأكد من أن `onUpdateItemPrice` يُمرر من `POS.tsx` بشكل صحيح
- التحقق من أن التعديل ينعكس فوراً على المجموع

#### 3. تقسيم تبويب المتجر في الإعدادات

تبويب "المتجر" الحالي يحتوي على كل شيء في صفحة واحدة طويلة. التقسيم:

**التبويب الفرعي 1: معلومات المتجر**
- اسم المتجر
- نوع المحل
- الهاتف
- البريد الإلكتروني
- العنوان
- الشعار
- إخفاء قسم الصيانة
- اللغة

**التبويب الفرعي 2: العملات والضرائب**
- أسعار الصرف (العملة الاولى والثانية)
- إعدادات الضريبة (تفعيل + نسبة)
- التحكم بالخصومات (خصم النسبة + خصم المبلغ)

يتم ذلك باستخدام تبويبات فرعية (`Tabs`) داخل case `'store'` في `renderTabContent()`.

---

### الملفات المعدلة

| الملف | التغيير |
|-------|---------|
| `src/pages/Settings.tsx` | تقسيم تبويب المتجر إلى تبويبين فرعيين |
| `src/components/pos/CartPanel.tsx` | إظهار حقل المبلغ المقبوض دائماً + سطر الباقي |
| `src/pages/POS.tsx` | التحقق من تمرير `onUpdateItemPrice` |
| `src/lib/i18n.ts` | إضافة ترجمات جديدة |

---

### التفاصيل التقنية

#### حقل المبلغ المقبوض (لجميع الأوضاع)

```text
الوضع الحالي:
  المبلغ المقبوض يظهر فقط عند wholesaleMode = true

الوضع الجديد:
  المبلغ المقبوض يظهر دائماً (أسفل الخصومات)
  
  البيع العادي:
    الإجمالي: 230
    المبلغ المقبوض: [250]
    الباقي: 20
  
  بيع الجملة:
    إجمالي الجملة: 230
    المبلغ المقبوض: [250]
    الربح: (محسوب من رأس المال)
```

#### تقسيم تبويب المتجر

```text
case 'store':
  return (
    <Tabs defaultValue="info">
      <TabsList>
        <TabsTrigger value="info">معلومات المتجر</TabsTrigger>
        <TabsTrigger value="finance">العملات والضرائب</TabsTrigger>
      </TabsList>
      
      <TabsContent value="info">
        <!-- اسم المتجر، النوع، الهاتف، البريد، العنوان، الشعار، الصيانة، اللغة -->
      </TabsContent>
      
      <TabsContent value="finance">
        <!-- أسعار الصرف، الضريبة، التحكم بالخصومات -->
      </TabsContent>
    </Tabs>
  );
```

#### مثال عملي - سلة المبيعات

```text
السلة:
  كتاب "1984" × 1 = [100] ← قابل للتعديل → أدخل 90
  كتاب "الخيميائي" × 1 = [150] ← قابل للتعديل → أدخل 140
  
  المجموع الفرعي: 230
  المبلغ المقبوض: [230]
  الباقي: 0
  الإجمالي: 230
```

