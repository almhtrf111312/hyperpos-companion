

## خطة: جولة تعليمية عند فتح التطبيق لأول مرة + شرح عائم للعناصر

### الفكرة العامة

عند فتح التطبيق لأول مرة بعد تسجيل الدخول، تظهر جولة تعليمية تفاعلية (Onboarding Tour) تشرح أهم أقسام وأزرار التطبيق خطوة بخطوة. يمكن للمستخدم التنقل بين الخطوات أو تخطي الجولة نهائياً. بالإضافة لذلك، عند التوقف بالماوس (hover) أو الضغط المطول على عناصر معينة، يظهر شرح عائم مختصر.

---

### الميزة الأولى: جولة تعليمية تفاعلية (Onboarding Tour)

**آلية العمل:**
- عند أول دخول للمستخدم إلى صفحة POS، يتم فحص `localStorage` لمفتاح `hp_onboarding_complete`
- إذا لم يكتمل، تبدأ الجولة تلقائياً
- كل خطوة تُعتّم الخلفية وتُبرز العنصر المشروح مع بطاقة شرح أنيقة بجانبه (Spotlight style)
- أزرار: "التالي" / "السابق" / "تخطي" + شريط تقدم (مثلاً: خطوة 3 من 8)
- عند الضغط على "تخطي" أو إكمال الجولة، يتم حفظ `hp_onboarding_complete = true`

**خطوات الجولة (8 خطوات):**

| الخطوة | العنصر | الشرح |
|--------|--------|-------|
| 1 | القائمة الجانبية (Sidebar) | "هذه القائمة الرئيسية للتنقل بين أقسام التطبيق" |
| 2 | زر نقطة البيع (POS) | "من هنا تبدأ عمليات البيع وإضافة المنتجات للسلة" |
| 3 | شبكة المنتجات (Product Grid) | "اضغط على أي منتج لإضافته إلى سلة المشتريات" |
| 4 | شريط البحث والتصنيفات | "ابحث عن المنتجات بالاسم أو الباركود، أو فلتر حسب التصنيف" |
| 5 | سلة المشتريات (Cart Panel) | "هنا تظهر المنتجات المضافة مع الإجمالي والخصومات" |
| 6 | زر السلة العائم (موبايل) | "اضغط هنا لفتح سلة المشتريات على الجوال" |
| 7 | لوحة التحكم (Dashboard) في القائمة | "عرض إحصائيات المبيعات والأرباح والمنتجات الأكثر مبيعاً" |
| 8 | الإعدادات في القائمة | "تخصيص إعدادات المتجر، المستخدمين، الطباعة، والنسخ الاحتياطي" |

---

### الميزة الثانية: شرح عائم (Tooltips) عند التوقف على العناصر

**العناصر التي ستحصل على شرح عائم:**

**القائمة الجانبية (عند طي القائمة - موجود بالفعل tooltip بسيط، سيتم تحسينه):**

| العنصر | الشرح |
|--------|-------|
| نقطة البيع | "إجراء عمليات البيع النقدي والآجل وإدارة السلة" |
| لوحة التحكم | "عرض ملخص المبيعات والأرباح والتنبيهات" |
| الفواتير | "عرض وطباعة ومشاركة جميع فواتير المبيعات" |
| المنتجات | "إضافة وتعديل وإدارة مخزون المنتجات" |
| المشتريات | "تسجيل فواتير الشراء من الموردين" |
| العملاء والديون | "إدارة بيانات العملاء وتتبع الديون والمدفوعات" |
| الصيانة | "تسجيل ومتابعة طلبات الصيانة والإصلاح" |
| المصروفات | "تسجيل المصروفات اليومية وتتبع النفقات" |
| الورديات | "فتح وإغلاق ورديات الكاشير ومراجعة الحسابات" |
| المستودعات | "إدارة المستودعات وتتبع المخزون في كل مستودع" |
| نقل المخزون | "نقل المنتجات بين المستودعات" |
| التقارير | "تقارير تفصيلية: المبيعات، الأرباح، المخزون، الديون" |
| الإعدادات | "إعدادات المتجر، المستخدمين، الطباعة، النسخ الاحتياطي" |

**تبويبات صفحة الإعدادات:**

| التبويب | الشرح |
|---------|-------|
| الملف الشخصي | "تعديل اسمك وبيانات حسابك الشخصي" |
| المتجر | "اسم المتجر ونوعه وعنوانه وأسعار الصرف" |
| حقول المنتج | "تخصيص الحقول الظاهرة عند إضافة المنتجات" |
| النسخ الاحتياطي | "إدارة النسخ الاحتياطية واستيراد/تصدير البيانات" |
| الإشعارات | "التحكم في إشعارات المبيعات والمخزون والديون" |
| الطباعة | "إعدادات طباعة الفواتير وحجم الورق" |
| المستخدمون | "إضافة مستخدمين جدد وتعيين الصلاحيات" |
| الترخيص | "عرض حالة الترخيص وتفعيل التطبيق" |
| الشركاء | "إدارة الشركاء وتوزيع الأرباح" |
| إعادة التعيين | "حذف جميع البيانات وإعادة ضبط التطبيق" |

---

### التغييرات المطلوبة

#### 1. ملف جديد: `src/components/onboarding/OnboardingTour.tsx`

- مكون الجولة التعليمية الرئيسي
- يستخدم نظام الخطوات مع Spotlight (تعتيم الخلفية + إبراز العنصر)
- أزرار التالي/السابق/تخطي مع شريط تقدم
- حفظ حالة الإكمال في `localStorage`
- دعم RTL/LTR
- تصميم أنيق مع حركات انتقالية سلسة

#### 2. ملف جديد: `src/components/onboarding/OnboardingStep.tsx`

- مكون البطاقة التي تظهر بجانب كل عنصر مشروح
- يحسب الموقع تلقائياً (أعلى/أسفل/يمين/يسار) حسب موقع العنصر
- يحتوي على: عنوان + وصف + أزرار تنقل + شريط تقدم

#### 3. ملف جديد: `src/components/onboarding/NavTooltips.tsx`

- مكون يضيف شرح عائم محسّن لعناصر القائمة الجانبية وتبويبات الإعدادات
- يظهر عند hover (سطح مكتب) أو ضغط مطول (جوال)
- تصميم بطاقة شرح صغيرة مع سهم يشير للعنصر

#### 4. تعديل: `src/pages/POS.tsx`

- إضافة مكون `OnboardingTour` داخل صفحة POS
- تمرير مراجع (refs) للعناصر المطلوب شرحها

#### 5. تعديل: `src/components/layout/Sidebar.tsx`

- إضافة `data-tour` attributes على عناصر القائمة لتسهيل استهدافها بالجولة
- تحسين tooltip العناصر المطوية بإضافة وصف مفصل

#### 6. تعديل: `src/pages/Settings.tsx`

- إضافة شرح عائم لكل تبويب في الإعدادات عبر tooltip محسّن

#### 7. تعديل: `src/lib/i18n.ts`

- إضافة جميع نصوص الجولة التعليمية والشروحات العائمة بالعربية والإنجليزية والتركية والفارسية والكردية

---

### التفاصيل التقنية

**تخزين الحالة:**
- `hp_onboarding_complete`: `true/false` -- هل أكمل المستخدم الجولة أو تخطاها
- يُفحص في `POS.tsx` عند التحميل الأول

**آلية Spotlight:**
- يتم حساب موقع العنصر المستهدف عبر `getBoundingClientRect()`
- تُعرض طبقة تعتيم (`overlay`) مع فتحة شفافة حول العنصر
- بطاقة الشرح تُوضع بجانب الفتحة بذكاء (تتجنب الخروج من الشاشة)

**آلية الشرح العائم المحسّن:**
- على سطح المكتب: يظهر بعد 800ms من hover
- على الجوال: يظهر بعد ضغط مطول (1 ثانية)
- يختفي عند تحريك الماوس أو رفع الإصبع

**ملخص الملفات:**

| الملف | النوع |
|-------|-------|
| `src/components/onboarding/OnboardingTour.tsx` | جديد |
| `src/components/onboarding/OnboardingStep.tsx` | جديد |
| `src/components/onboarding/NavTooltips.tsx` | جديد |
| `src/pages/POS.tsx` | تعديل |
| `src/components/layout/Sidebar.tsx` | تعديل |
| `src/pages/Settings.tsx` | تعديل |
| `src/lib/i18n.ts` | تعديل |

