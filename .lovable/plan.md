

## خطة إصلاح: شاشة سوداء + صفحة الخصوصية الجديدة + مؤشر الاتصال في القائمة الجانبية

### المشكلة 1: شاشة سوداء عند فتح التطبيق على الهاتف (APK)

**التشخيص:**
صفحة Login تعتمد على مكونات تستخدم `bg-background` و `text-foreground` من CSS variables. إذا لم يتم تحميل ملف CSS بشكل صحيح في WebView، تظهر شاشة سوداء بدون أي محتوى مرئي. أيضاً، شاشة الخصوصية (`PrivacyPolicyScreen`) التي تظهر قبل Login تستخدم `bg-background` والتي قد تكون سوداء في الوضع المظلم بدون أي محتوى واضح.

**الحل:**
- إضافة ألوان احتياطية (fallback) في `index.html` على عنصر `body` لضمان خلفية مرئية حتى قبل تحميل CSS
- إضافة أنماط مضمّنة (inline styles) على شاشة الخصوصية كطبقة أمان إضافية

---

### المشكلة 2: إعادة تصميم صفحة الخصوصية

**التصميم الجديد:**
بدلاً من زر يفتح حواراً، ستكون صفحة كاملة تعرض الشروط مباشرة:
- عنوان + أيقونة في الأعلى
- نص الشروط بالكامل في منطقة قابلة للتمرير (scroll)
- خانة اختيار (checkbox) "أوافق على الشروط وإخلاء المسؤولية" -- تكون باهتة ومعطلة حتى يمرر المستخدم للأسفل بالكامل
- زر "موافق" -- معطل وباهت حتى يتم تفعيل خانة الاختيار والضغط عليها
- عند تفعيل خانة الاختيار، يتحول لون الزر إلى لون الثيم الرئيسي
- عند الضغط على "موافق"، يتم حفظ الموافقة وعرض صفحة تسجيل الدخول

---

### المشكلة 3: مؤشر حالة الاتصال في القائمة الجانبية

**التصميم:**
- إضافة `NetworkStatusIndicator` في أسفل القائمة الجانبية، فوق قسم المستخدم مباشرة
- يعرض دائماً (وليس فقط عند عدم الاتصال): "متصل بالإنترنت" باللون الأخضر أو "غير متصل" باللون الأحمر
- يظهر مع نص وصفي عندما تكون القائمة مفتوحة، وأيقونة فقط عندما تكون مطوية

---

### الملفات المطلوب تعديلها

| الملف | العملية |
|-------|---------|
| `index.html` | تعديل - إضافة ألوان احتياطية على body |
| `src/components/PrivacyPolicyScreen.tsx` | تعديل - إعادة تصميم كصفحة كاملة مع scroll detection |
| `src/components/layout/Sidebar.tsx` | تعديل - إضافة NetworkStatusIndicator |
| `src/components/layout/NetworkStatusIndicator.tsx` | تعديل - إضافة وضع expanded مع نص |

---

### التفاصيل التقنية

#### 1. index.html
```text
- إضافة style مضمّن على body:
  background-color: #0a0a0a; color: #fafafa;
- هذا يضمن أن الصفحة لا تظهر بيضاء بالكامل أو سوداء بدون نص
```

#### 2. PrivacyPolicyScreen.tsx - إعادة تصميم كاملة
```text
- إزالة زر فتح الحوار وكل منطق dialogOpen
- عرض النص مباشرة في صفحة كاملة الشاشة
- إضافة ref على عنصر ScrollArea لمراقبة التمرير
- عند وصول المستخدم لنهاية النص (scrollTop + clientHeight >= scrollHeight - 20):
  تفعيل الـ checkbox (إزالة disabled و opacity-50)
- الـ checkbox معطل بصرياً (opacity-50 + pointer-events-none) حتى يتم التمرير للنهاية
- زر "موافق" معطل (disabled + opacity) حتى يضغط المستخدم على الـ checkbox
- عند الضغط على checkbox: الزر يصبح بلون primary ومفعّل
- إضافة inline style احتياطي (backgroundColor, color) لتجنب الشاشة السوداء
```

#### 3. Sidebar.tsx
```text
- إضافة import لـ NetworkStatusIndicator
- إضافة المؤشر في المنطقة بين nav والـ user section
- في الوضع المطوي: أيقونة فقط
- في الوضع الموسع: أيقونة + نص "متصل" أو "غير متصل"
```

#### 4. NetworkStatusIndicator.tsx
```text
- إضافة خاصية showLabel لعرض النص بجانب الأيقونة
- عند showLabel=true: عرض "متصل بالإنترنت" أو "غير متصل بالإنترنت"
- إزالة شرط compact الذي يخفي المؤشر عند الاتصال
- المؤشر يظهر دائماً بغض النظر عن حالة الاتصال
```

---

### السلوك المتوقع

1. فتح التطبيق: تظهر صفحة الشروط بخلفية واضحة (لا شاشة سوداء)
2. المستخدم يمرر للأسفل: خانة الاختيار تصبح مفعّلة
3. المستخدم يضغط على خانة الاختيار: زر "موافق" يتحول للون الثيم
4. المستخدم يضغط "موافق": تفتح صفحة تسجيل الدخول
5. بدون إنترنت: صفحة تسجيل الدخول تفتح عادياً مع مؤشر "غير متصل" في القائمة الجانبية
6. القائمة الجانبية: تعرض دائماً حالة الاتصال فوق معلومات المستخدم

