

## خطة إصلاح: تعديل سعر المنتج في سلة المبيعات

### المشكلة
حقل تعديل السعر في سلة المبيعات يعاني من 3 مشاكل:
1. عند حذف السعر يظهر `0` فوراً (بدلاً من حقل فارغ)
2. عند كتابة رقم بعد الصفر يصبح مثلاً `10` بدلاً من `1`
3. على الهاتف المحمول لا يمكن الكتابة في الحقل إطلاقاً

### السبب الجذري
الحقل الحالي يستخدم `value={getItemPrice(item)}` مربوطاً مباشرة بالرقم المحسوب. عند حذف النص، `Number("")` يُرجع `0` فتتحدث الحالة فوراً للصفر. والمتصفح يُبقي المؤشر بعد الصفر، فكتابة `1` تصبح `01` أو `10`. على الهاتف، المتصفح يرفض التعديل لأن القيمة الرقمية تتعارض مع النص المُدخل.

### الحل
استبدال الحقل الحالي بمكوّن `EditablePrice` يستخدم حالة نصية محلية (`string state`) أثناء التحرير، ولا يُرسل القيمة الرقمية النهائية إلا عند مغادرة الحقل (`onBlur`) أو الضغط على Enter.

### الملفات المطلوب تعديلها

| الملف | التعديل |
|-------|---------|
| `src/components/pos/CartPanel.tsx` | استبدال حقل Input بمكوّن EditablePrice جديد داخل نفس الملف |

### التفاصيل التقنية

#### مكوّن EditablePrice الجديد (داخل CartPanel.tsx)

```text
- حالة محلية: localValue (string) + isEditing (boolean)
- عند التركيز (onFocus): تحويل السعر الرقمي إلى نص، وتحديد كل النص
- أثناء الكتابة (onChange): تحديث localValue فقط (نص حر)
- عند المغادرة (onBlur) أو Enter:
  - تحويل النص لرقم بـ parseFloat
  - إذا كان NaN أو فارغ → إرجاع السعر الأصلي
  - إذا كان رقم صالح → استدعاء onUpdateItemPrice
- نوع الحقل: inputMode="decimal" بدلاً من type="number"
  (يُظهر لوحة أرقام على الهاتف بدون قيود المتصفح)
```

#### السلوك المتوقع بعد الإصلاح
- حذف السعر → حقل فارغ (بدون صفر تلقائي)
- كتابة `1` → يظهر `1` (وليس `10`)
- على الهاتف → يعمل بشكل طبيعي
- الضغط خارج الحقل → يُطبّق السعر الجديد
- السعر المعدّل يُحفظ ويُطبع بالفاتورة بالقيمة الصحيحة (لأن `onUpdateItemPrice` يُحدّث `item.price` مباشرة والذي يُستخدم في حساب `subtotal` و `total` و `itemsWithCost` عند الحفظ)

