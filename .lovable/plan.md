
# خطة التعديلات على مراحل

## المرحلة 1: إصلاح القائمة الجانبية (Sidebar)

### المشكلة 1: كلمة "FlowPOS Pro" مقصوصة من الأعلى
السبب: الـ `pt-[env(safe-area-inset-top)]` على العنصر الرئيسي يضغط المحتوى، لكن ارتفاع الـ Logo header ثابت عند `h-16` مما قد لا يكفي.

**الحل:** إضافة `mt-1` أو تعديل padding داخلي في منطقة اللوغو لضمان عدم خروج النص من الإطار.

**الملف:** `src/components/layout/Sidebar.tsx` - سطر 171

### المشكلة 2: زر القائمة الجانبي (MobileMenuTrigger) يغطي أيقونة التاج في لوحة البوس
السبب: الزر في `top-[calc(0.75rem+env(safe-area-inset-top))]` يتداخل مع أيقونة التاج في الـ header.

**الحل:** تعديل موقع الزر الجانبي أو إضافة `padding-top` مناسب لمحتوى لوحة البوس ليتجنب التداخل. الأفضل هو إضافة padding علوي في الصفحة عند الموبايل.

**الملف:** `src/pages/BossPanel.tsx` - سطر 747، إضافة `pt-12 md:pt-0` لتفادي تداخل الزر العائم.

---

## المرحلة 2: إضافة إنشاء مالك (Owner) من لوحة البوس

### الوضع الحالي
- لوحة البوس تعرض المستخدمين لكن لا تحتوي على زر "إضافة مالك جديد"
- إضافة Boss موجودة في `ProfileManagement.tsx` (الإعدادات)

### الحل
إضافة زر "إضافة مالك جديد" في قسم "المستخدمين المسجلين" في لوحة البوس:
- عند الضغط، تظهر نافذة تطلب: الإيميل، كلمة المرور، الاسم الكامل
- يتم استدعاء Edge Function `create-user` مع `role: 'admin'` (بدون owner_id ليكون مالك مستقل)

**ملاحظة:** هذا يختلف عن إنشاء Boss. المالك (Admin) هو حساب مستقل بترخيص منفصل. أما Boss فهو حساب سوبر أدمن.

**الملف:** `src/pages/BossPanel.tsx` - إضافة state + dialog + handler

---

## المرحلة 3: إضافة إنشاء Boss من لوحة البوس + طلب كلمة مرور

### الوضع الحالي
إنشاء Boss موجود فقط في `ProfileManagement.tsx` (الإعدادات > الملف الشخصي)

### الحل
نقل/نسخ إمكانية إنشاء Boss إلى لوحة البوس مع إضافة طلب كلمة مرور البوس الحالي للتأكيد:
- زر "إضافة حساب Boss" بجانب زر "إضافة مالك"
- عند الضغط: نافذة تطلب إيميل + كلمة مرور الحساب الجديد + الاسم + **كلمة مرور البوس الحالي للتأكيد**
- يتم التحقق من كلمة مرور البوس عبر `signInWithPassword` قبل استدعاء `create-boss-account`

**الملف:** `src/pages/BossPanel.tsx`

---

## المرحلة 4: طلب كلمة مرور عند حذف حساب Boss

### الوضع الحالي
حذف Boss موجود في `ProfileManagement.tsx` بدون طلب كلمة مرور

### الحل
عند حذف حساب Boss من لوحة البوس، يجب طلب كلمة مرور البوس الحالي قبل التنفيذ (نفس آلية نقل الترخيص).

**الملف:** `src/pages/BossPanel.tsx` - تعديل `deleteConfirm` dialog ليطلب كلمة مرور عند نوع Boss

---

## المرحلة 5: إزالة قسم "حسابات البوس" من إعدادات الملف الشخصي

### الوضع الحالي
`ProfileManagement.tsx` يحتوي على قسم "حسابات Boss" بالأسفل (إضافة/حذف Boss)

### الحل
إزالة قسم حسابات Boss بالكامل من `ProfileManagement.tsx` لأن الإدارة ستكون حصريا من لوحة البوس.

**الملف:** `src/components/settings/ProfileManagement.tsx` - إزالة:
- State variables المتعلقة بـ Boss accounts
- دوال `fetchBossAccounts`, `handleAddBossAccount`, `handleDeleteBossAccount`
- قسم UI "حسابات Boss" والـ Dialogs المرتبطة

---

## ملخص الملفات المتأثرة

| الملف | التعديل |
|-------|---------|
| `src/components/layout/Sidebar.tsx` | إصلاح ارتفاع اللوغو |
| `src/pages/BossPanel.tsx` | padding علوي + إضافة مالك + إضافة Boss + حذف Boss بكلمة مرور |
| `src/components/settings/ProfileManagement.tsx` | إزالة قسم حسابات Boss |

## ترتيب التنفيذ

| المرحلة | الوصف | التعقيد |
|---------|-------|---------|
| 1 | إصلاح Sidebar + تداخل الزر | منخفض |
| 2 | إضافة إنشاء مالك من لوحة البوس | متوسط |
| 3 | إضافة إنشاء Boss مع تأكيد كلمة المرور | متوسط |
| 4 | طلب كلمة مرور عند حذف Boss | منخفض |
| 5 | إزالة قسم Boss من الإعدادات | منخفض |
