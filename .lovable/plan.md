
# تنفيذ نظام الفرن (المخبز) - بدون مخزون، مع تركيز على المبيعات والمشتريات والأرباح

## الفكرة العامة
وضع "المخبز/الفرن" يعمل بنظام مختلف عن بقية أنواع المتاجر:
- المنتجات = قائمة أسعار فقط (بدون تتبع كمية أو مخزون)
- المشتريات = تسجيل فواتير شراء مواد خام كمصروف (بدون زيادة مخزون)
- الربح = المبيعات - المشتريات - المصاريف
- إخفاء: المستودعات، تحويل العهدة، تنبيهات المخزون، قيمة المخزون

## التغييرات المطلوبة

### 1. إضافة دالة للتعرف على وضع "بدون مخزون"
**الملف:** `src/lib/store-type-config.ts`

- إضافة دالة `isNoInventoryMode(storeType)` تُرجع `true` عند `bakery`
- هذه الدالة ستُستخدم في كل الأماكن التي تحتاج إلى تحديد ما إذا كان المخزون مُفعّل أم لا

### 2. إخفاء روابط القائمة الجانبية غير المطلوبة
**الملف:** `src/components/layout/Sidebar.tsx`

- إخفاء "المستودعات" و "تحويل العهدة" عندما يكون `isNoInventoryMode` = true
- إضافة خاصية `hideInNoInventory` لعناصر القائمة المعنية

### 3. تعديل نقطة البيع (POS) - تجاوز خصم المخزون
**الملف:** `src/components/pos/CartPanel.tsx`

- في وضع الفرن: تجاوز خطوة `deductStockBatchCloud` و `checkStockAvailabilityCloud`
- السماح بالبيع بكميات غير محدودة (لأنه لا يوجد مخزون)
- الفاتورة تُسجل بشكل طبيعي مع الأرباح

### 4. تعديل صفحة المنتجات - إخفاء عمود الكمية
**الملف:** `src/pages/Products.tsx`

- في وضع الفرن: إخفاء عمود "الكمية" و "حالة المخزون" من الجدول
- تبسيط نموذج الإضافة (إخفاء حقل الكمية والحد الأدنى للمخزون)
- المنتجات تُضاف بكمية افتراضية كبيرة (مثل 99999) لمنع أي تحقق من المخزون

### 5. تعديل لوحة التحكم (Dashboard)
**الملف:** `src/pages/Dashboard.tsx`

- في وضع الفرن: إخفاء بطاقة "قيمة المخزون"
- إخفاء قسم "تنبيهات المخزون المنخفض" (LowStockAlerts)
- إضافة بطاقة "إجمالي المشتريات" (مجموع فواتير الشراء) بدلا من قيمة المخزون
- صافي الربح = المبيعات - المشتريات - المصاريف

### 6. تعديل فواتير الشراء - بدون زيادة مخزون
**الملف:** `src/components/products/PurchaseInvoiceDialog.tsx`

- في وضع الفرن: عند إتمام فاتورة الشراء، لا يتم زيادة كمية المنتجات في المخزون
- تُسجل الفاتورة كسجل مالي فقط

### 7. تعديل معالج البيع Offline
**الملف:** `src/lib/cloud/cash-sale-handler.ts`

- في وضع الفرن: تجاوز خطوة خصم المخزون (`deductStockBatchCloud` / `deductWarehouseStockBatchCloud`)

## التفاصيل التقنية

### الملفات المعدّلة:
1. `src/lib/store-type-config.ts` - إضافة `isNoInventoryMode()`
2. `src/components/layout/Sidebar.tsx` - إخفاء روابط المخزون في وضع الفرن
3. `src/components/pos/CartPanel.tsx` - تجاوز خصم المخزون والتحقق منه
4. `src/pages/Products.tsx` - إخفاء أعمدة الكمية والمخزون
5. `src/pages/Dashboard.tsx` - إخفاء بطاقة المخزون + إضافة بطاقة المشتريات
6. `src/components/products/PurchaseInvoiceDialog.tsx` - تجاوز زيادة المخزون
7. `src/lib/cloud/cash-sale-handler.ts` - تجاوز خصم المخزون في الوضع Offline

## النتيجة المتوقعة
- الفرن يعمل كنظام مبسّط: بيع أصناف بأسعار محددة، تسجيل فواتير شراء مواد خام، تسجيل مصاريف يومية
- لوحة التحكم تعرض: المبيعات، المشتريات، المصاريف، وصافي الربح
- لا وجود لأي مرجع للمخزون أو الكميات في واجهة المستخدم
